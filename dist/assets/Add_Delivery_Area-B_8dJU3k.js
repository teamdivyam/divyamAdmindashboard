import{p as Q,r as m,j as X,i as ee,a as te,o as ae,R as e,B as w,N as ne,L as f,I as re,s as se,v as le,w as ce,x as oe,g as ie,y as me,h as g,_}from"./index-CqUjVgox.js";import{C as O,I as de,d as pe,a as I}from"./ComboBox_select-CDuojwjQ.js";import{T as ue}from"./sonner-iBYa7rjY.js";import{D as z,a as M,b as R,c as V,d as j}from"./dialog-D93OiIH2.js";import{S as fe}from"./switch-DfwVWSm4.js";import{w as E}from"./index-DLdLSjkK.js";import{M as ge}from"./map-pin-DxJRDjmM.js";import{S as Ee}from"./search-DXH-IQ_M.js";import"./format-SmSpYad1.js";import"./chevron-left-Dv4wvR6C.js";import"./select-BL-mDBSJ.js";import"./index-D5qU_uVB.js";import"./chevron-up-yYAkaWBY.js";import"./calendar-DGlsJCaW.js";import"./command-D2bKaY6J.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=Q("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Se=/^[1-9]{1}[0-9]{5}$/;function F(s){const r=new Date(s),D=r.getFullYear(),l=String(r.getMonth()+1).padStart(2,"0"),v=String(r.getDate()).padStart(2,"0"),x=String(r.getHours()).padStart(2,"0"),h=String(r.getMinutes()).padStart(2,"0"),y=String(r.getSeconds()).padStart(2,"0"),p=String(r.getMilliseconds()).padStart(3,"0"),o=r.getTimezoneOffset(),a=Math.abs(o),A=String(Math.floor(a/60)).padStart(2,"0"),C=String(a%60).padStart(2,"0"),P=`${o<=0?"+":"-"}${A}:${C}`;return`${D}-${l}-${v}T${x}:${h}:${y}.${p}${P}`}const Ne=ie({state:g().trim().min(3).required(),district:g().trim().min(3).required(),areaPinCode:g().required().matches(Se,"Invalid Pin code"),startDate:g().trim().required(),endDate:g().trim().required(),isAvailable:me().required()}),Me=()=>{var $;const s=m.useRef(null),[r,D]=m.useState(!1),[l,v]=m.useState(null),[x,h]=m.useState(!1),[y,p]=m.useState(!1),o=X(),a=ee(t=>t.AreaZone),A=t=>{t.preventDefault();const n=s.current.value,S=/^[1-9]{1}[0-9]{5}$/.test(n),i=async()=>{var T;try{const N=await fetch(`https://api.postalpincode.in/pincode/${n}`,{cache:"force-cache",method:"GET","Content-Type":"application/json",charset:"utf-8",Accept:"application/json, application/xml","Accept-Language":"en_US"});if(!N.ok){D(!0);return}const b=await N.json();console.log("Status",`${l&&l.length>0?l.Status:null}`),b&&v((T=b==null?void 0:b[0])==null?void 0:T.PostOffice)}catch(N){console.log(N)}};if(!S){E.error("Please enter valid pin code");return}i(),h(!0)},{register:C,handleSubmit:L,reset:P,setValue:d,getValues:be,watch:q,trigger:k,formState:u}=te({mode:"all",resolver:ae(Ne),defaultValues:{state:"",district:"",areaPinCode:"",startDate:"",endDate:"",isAvailable:""}}),B=localStorage.getItem("AppID");u.errors;const H=async t=>{if(t.preventDefault(),!await k()){E.error("Umm! please fill the form correctly..");return}},{state:U,district:Z,areaPinCode:G,startDate:J,endDate:K,isAvailable:W}=q(),Y=async()=>{const t={state:U,district:Z,areaPinCode:G,startDate:J,endDate:K,isAvailable:W},n=async()=>{try{const i=await(await fetch(`${_&&_.BACKEND_URL}/api/admin/areas-zone`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${B}`,Accept:"application/json, application/xml","Accept-Language":"en_US"},body:JSON.stringify(t)})).json();i.success||E.error(i==null?void 0:i.msg),i.success&&E.success("New area zone created successfully.")}catch(S){console.log(S)}};if(!await k()){E.error("Please fill the form Carefully.");return}n()};return m.useEffect(()=>{d("state",a==null?void 0:a.state),d("district",a==null?void 0:a.district),d("areaPinCode",a==null?void 0:a.areaPinCode),d("startDate",a==null?void 0:a.startDate),d("endDate",a.endDate),d("isAvailable",a.isAvailable)},[a]),m.useEffect(()=>{console.log(u==null?void 0:u.errors)},[u]),e.createElement(e.Fragment,null,e.createElement(ue,{richColors:!0}),e.createElement(z,{open:y,onOpenChange:p},e.createElement(M,null,e.createElement(R,null,e.createElement(V,null,"Confirm Location Availability"),e.createElement(j,null,e.createElement("span",{className:"mt-2"},"Please review the location details you've entered. If everything looks correct, click Save to confirm. If you need to make changes, you can go back and edit the information"),e.createElement("span",{className:"border-t  border-slate-100 mt-3  flex  gap-2 justify-end"},e.createElement(w,{variant:"secondary",className:"mt-4 ",onClick:()=>{p(t=>!t)}},"Cancel"),e.createElement(w,{variant:"secondary",className:"mt-4 bg-orange-300 text-white w-20 hover:bg-orange-400",onClick:()=>{Y()}},"Save")))))),e.createElement(z,{open:x,onOpenChange:h},e.createElement(M,null,e.createElement(R,null,e.createElement(V,{className:"border-b pb-4"},"Area by Pincode"),e.createElement(j,null,e.createElement("span",null,e.createElement("ul",null,l&&l.length>0?l.map((t,n)=>e.createElement("li",{className:"flex items-center",key:t==null?void 0:t.Name},e.createElement("span",{className:"bg-white rounded-full p-2 text-green-600"},e.createElement(he,{className:"size-4"})),t==null?void 0:t.Name)):e.createElement("span",null))),e.createElement(ne,{target:"_blank",to:`https://www.google.com/maps/search/${($=s==null?void 0:s.current)==null?void 0:$.value}
`,className:"w-full block h-10 mt-4 p-2 rounded-md border  bg-gray-300"},e.createElement("span",{className:"flex justify-center items-center gap-2"},e.createElement("span",{className:"animate-pulse "},"View area On Map"),e.createElement("span",{className:"animate-pulse"},e.createElement(ge,{className:"text-green-600 animate-pulse "})))))))),e.createElement("div",{className:"mx-auto"},e.createElement("div",{className:" mx-4 rounded-sm p-2 py-4"},e.createElement("h1",{className:"capitalize text-2xl border-b font-normal pb-3"},"Add new area zone"),e.createElement("div",{className:"border  mx-auto max-w-2xl rounded-md bg-slate-50 p-4 mt-6",id:"form_wrapper"},e.createElement("form",{className:"flex flex-col gap-4",onSubmit:t=>H(t)},e.createElement("div",{className:"flex flex-col gap-2"},e.createElement(f,{htmlFor:"state",className:"text-neutral-400"},"State"),e.createElement("span",{className:"w-full "},e.createElement(O,{placeHolderText:"Select State",optionsText:de,inputType:"STATE"}))),e.createElement("div",{className:"flex flex-col gap-2 "},e.createElement(f,{htmlFor:"district",className:"text-neutral-400"},"District"),e.createElement(O,{inputType:"DISTRICT",placeHolderText:"Select district",optionsText:pe})),e.createElement("div",{className:"flex flex-col gap-2 -mt-2"},e.createElement(f,{htmlFor:"areaPin",className:"text-neutral-400 "},"Pin code"),e.createElement("span",{className:" flex h-10"},e.createElement(re,{className:`
                border-r-0
               rounded-r-none
                h-12`,placeholder:"Enter area pin code",ref:s,onChange:t=>{var n,c;s.current.value=(n=t==null?void 0:t.target)==null?void 0:n.value,o(se((c=t==null?void 0:t.target)==null?void 0:c.value))}}),e.createElement("button",{onClick:t=>A(t)},e.createElement("span",{className:"bg-orange-300 rounded-sm h-12  w-12  text-white border-l-0 rounded-l-none flex justify-center items-center"},e.createElement(Ee,{className:"size-4"}))))),e.createElement("div",{className:"flex flex-col gap-2"},e.createElement(f,{htmlFor:"firstDate",className:"text-neutral-400 "},"Start Date"),e.createElement(I,{date:"09/02/2021",onDateSelect:({from:t,to:n})=>{const c=F(t);o(le(c))},variant:"outline",numberOfMonths:1,className:"min-w-[150px]  "})),e.createElement("div",{className:"flex flex-col gap-2"},e.createElement(f,{htmlFor:"firstDate",className:"text-neutral-400 "},"End Date"),e.createElement(I,{date:"01/09/2021",onDateSelect:({from:t,to:n})=>{const c=F(t);o(ce(c))},variant:"outline",numberOfMonths:1,className:"min-w-[150px] "})),e.createElement("div",{className:"border p-4 rounded-md shadow-sm flex justify-between items-center"},e.createElement("div",{className:"toggleSwitchTextContent"},e.createElement("h3",{className:"font-medium"},"Service Availability"),e.createElement("p",{className:"text-neutral-500"},"Set the status if the service is available or offline.")),e.createElement(fe,{className:"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-orange-200",onCheckedChange:t=>{o(oe())}})),e.createElement("div",{className:"flex flex-col gap-2"},e.createElement(w,{className:"bg-[#ffa94e] uppercase font-semibold hover:bg-orange-300 mt-5 h-12",onClick:()=>{p(!0)}},"Add New area zone")))))))};export{Me as default};
