import{a as e,r as c}from"./react-BM40__SY.js";import{S as b,_ as x,u as ie,f as me,r as B,I as k,B as P,L as N}from"./index-fHwZLE-T.js";import{T as R}from"./textarea-CVz0WJ5F.js";import{B as q}from"./badge-DAiYVQtE.js";import{T as pe}from"./sonner-UVoS8Wfh.js";import{w as C}from"./sonner-CBLC4ypc.js";import{M as K}from"./Modal-aaWU-vqU.js";import{R as de}from"./react-rating-stars-component-BRBZw8gx.js";import{D as ue,a as ge,b as Ee,c as ye,d as he}from"./dialog-CwGvPLDO.js";import{o as H}from"./@hookform-D0jWCfUg.js";import{c as G,a as E}from"./yup-DazPcaNu.js";import{u as V}from"./react-hook-form-BN_naEWj.js";import{u as J}from"./react-dropzone-xdj4i9O1.js";import{S as Y,g as W}from"./extractFileNameFromImgUrl-BGUkp9r3.js";import{i as X}from"./browser-image-compression-BgY3rL5_.js";import{n as Q}from"./@reduxjs-DtXgGc0i.js";import{u as z,a as U}from"./react-redux-DNfLtVbP.js";import{X as F,l as fe,a as Ne}from"./lucide-react-BWZ2dPnB.js";import{c as be}from"./react-router-DRLUvzUh.js";import"./attr-accept-CkmCM30I.js";import"./react-dom-BKOhnANa.js";import"./scheduler-C323NY8X.js";import"./@radix-ui-Bvz2HI7m.js";import"./react-remove-scroll-DR3rXkvR.js";import"./tslib-eMSY344_.js";import"./react-remove-scroll-bar-BhARyL5A.js";import"./react-style-singleton-DeLYGn6u.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-CISbmOY4.js";import"./use-callback-ref-Bp38XRF0.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@floating-ui-DHl6l98I.js";import"./class-variance-authority-Dp3B9jqt.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-D696Ktp4.js";import"./react-google-recaptcha-C2_uU7Xm.js";import"./prop-types-DFk7-3jw.js";import"./react-async-script-BL5K2liq.js";import"./hoist-non-react-statics-CPzswhKp.js";import"./react-is-CnyDuYXe.js";import"./jwt-decode-VWaDGczM.js";import"./recharts-BSzae8HI.js";import"./lodash-DiYzGN5e.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-nwul2LtV.js";import"./d3-path-CimkQT29.js";import"./react-smooth-DYD8lKML.js";import"./fast-equals-BIyco3rD.js";import"./victory-vendor-eFgrrWDw.js";import"./d3-scale-DCNNTN8k.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-j2_s_XYn.js";import"./d3-time-g9mLz1m7.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-CEDTliZZ.js";import"./decimal.js-light-ZKFLnszB.js";import"./eventemitter3-BRe_pui0.js";import"./property-expr-DwgEMw67.js";import"./tiny-case-Gl8mQWqo.js";import"./toposort-tjHGMS6M.js";import"./use-sync-external-store-H6R0MgJP.js";import"./redux-BXkGT1VS.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./cookie--_YQFYBD.js";import"./next-themes-05dgSDaz.js";import"./react-modal-Cc-lLjh3.js";import"./warning-5T6J0T5c.js";import"./exenv-BS7ugsZD.js";import"./react-lifecycles-compat-CbhsFY8R.js";import"./file-selector-Bf0AE8ON.js";const xe=localStorage.getItem("AppID"),ve=async t=>{try{return await(await fetch(`${x.BACKEND_URL}/api/admin/get-presigned-url`,{method:"POST",headers:{Authorization:`Bearer ${xe}`,"Content-Type":"application/json"},body:JSON.stringify({fileName:t})})).json()}catch{throw new Error("cant get presigned url")}},we=({ToggleModal:t})=>{const[o,l]=c.useState(),d=z(),s=U(r=>r.UploadedImgs.banners),y=async r=>{const u=`UI/product-banner/${Q(12)}-${r[0].name}`;l(!0);try{const{url:i,key:_}=await ve(u),I={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},m=await X(r[0],I);await(async()=>{if(!(await fetch(i,{method:"PUT",headers:{"Content-Type":r[0].type},body:m})).ok)throw new Error("Error during file upload");const h=`${x.IMAGE_CDN}/${u}`;console.log("Uploaded Image URL:",h),l(!1);const p={imgUrl:h,fileName:r[0].name,fileSize:m.size};d(ie(p))})()}catch(i){console.error("Upload Error:",i),l(!1)}},{acceptedFiles:S,getRootProps:v,getInputProps:w}=J({onDrop:y,accept:{"image/*":[]}});return e.createElement("div",{className:"lg:min-w-[800px] "},e.createElement("div",{className:"file_Upload__header border-b flex justify-between p-4"},e.createElement("h2",{className:"text-gray-600 text-2xl "},"Upload Banner Images"),e.createElement("span",{className:"close-icon hover:bg-gray-800 size-10 flex justify-center items-center rounded-full group ease-in duration-75 transition-colors",id:"modal-close",onClick:t},e.createElement(F,{className:"text-gray-300 size-8 cursor-pointer group-hover:text-white"}))),e.createElement("div",{className:"file-upload-wrapper px-4 my-4"},e.createElement("div",{...v({className:"dropzone"}),className:"rounded-md border-2 border-dashed mx-auto w-5/6 my-4 p-6 cursor-copy"},e.createElement("input",{...w()}),e.createElement("p",{className:"text-gray-300"},"Drag 'n' drop some files here, or click to select files")),o&&e.createElement("div",{className:"container border p-3 rounded-md transition-all ease-in mb-2"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(b,{className:"h-12 w-12 rounded-md"}),e.createElement("div",{className:"space-y-2"},e.createElement(b,{className:"h-4 w-[250px]"}),e.createElement(b,{className:"h-4 w-[50px]"})))),e.createElement("div",{className:"flex flex-col gap-2"},s&&s.length>=0&&s.map(r=>e.createElement(Y,{File:r,Size:r.fileSize,key:r.id,ImgUrl:r.imgUrl,ISUploading:o})))))},Ie=e.memo(we),Se=async t=>{const o=localStorage.getItem("AppID");try{return await(await fetch(`${x.BACKEND_URL}/api/admin/get-presigned-url`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({fileName:t})})).json()}catch{throw new Error("cant get presigned url")}},De=({ToggleModal:t})=>{const[o,l]=c.useState(),d=z(),s=U(r=>r.UploadedImgs.productImages),y=async r=>{const u=`UI/product-Img/${Q(12)}-${r[0].name}`;l(!0);try{const{url:i,key:_}=await Se(u),I={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},m=await X(r[0],I);await(async()=>{if(!(await fetch(i,{method:"PUT",headers:{"Content-Type":r[0].type},body:m})).ok)throw new Error("Error during file upload");const h=`${x.IMAGE_CDN}/${u}`;l(!1);const p={imgUrl:h,fileName:r[0].name,fileSize:m.size};d(me(p))})()}catch(i){console.error("Upload Error:",i),l(!1)}},{acceptedFiles:S,getRootProps:v,getInputProps:w}=J({onDrop:y,accept:{"image/*":[]}});return e.createElement("div",{className:"lg:min-w-[800px] "},e.createElement("div",{className:"file_Upload__header border-b flex justify-between p-4"},e.createElement("h2",{className:"text-gray-600 text-2xl "},"Upload Product Images"),e.createElement("span",{className:"close-icon hover:bg-gray-800 size-10 flex justify-center items-center rounded-full group ease-in duration-75 transition-colors",id:"modal-close",onClick:t},e.createElement(F,{className:"text-gray-300 size-8 cursor-pointer group-hover:text-white"}))),e.createElement("div",{className:"file-upload-wrapper px-4 my-4"},e.createElement("div",{...v({className:"dropzone"}),className:"rounded-md border-2 border-dashed mx-auto w-5/6 my-4 p-6 cursor-copy"},e.createElement("input",{...w()}),e.createElement("p",{className:"text-gray-300"},"Drag 'n' drop some files here, or click to select files")),o&&e.createElement("div",{className:"container border p-3 rounded-md transition-all ease-in mb-2"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(b,{className:"h-12 w-12 rounded-md"}),e.createElement("div",{className:"space-y-2"},e.createElement(b,{className:"h-4 w-[250px]"}),e.createElement(b,{className:"h-4 w-[50px]"})))),e.createElement("div",{className:"flex flex-col gap-2"},s&&s.length>=0&&s.map(r=>e.createElement(Y,{File:r,Size:r.fileSize,key:r.id,ImgUrl:r.imgUrl,ISUploading:o})))))},ke=e.memo(De),Pe=G({name:E().required("Package Name is required."),capacity:E().required("capacity is required."),price:E().required("price is required."),description:E().required("description is required."),notes:E(),policy:E()}),Ce={pkg_name:"",capacity:"",price:"",notes:"",description:"",file:""},Ue=(t,o)=>{switch(o.type){case"ADD_PKG_NAME":return{...t,pkg_name:o.payload};case"ADD_CAPACITY":return{...t,capacity:o.payload};case"ADD_PRICE":return{...t,price:`â‚¹${o.payload}`};case"ADD_NOTES":return{...t,notes:o.payload};case"ADD_DESC":return{...t,description:o.payload};default:return t}},ta=()=>{var $;const[t,o]=c.useReducer(Ue,Ce),[l,d]=c.useState(!1),[s,y]=c.useState([]),[S,v]=c.useState(),[w,r]=c.useState(),[u,i]=c.useState(),_=be(),I=z(),m=U(a=>a.UploadedImgs.banners),A=U(a=>a.UploadedImgs.productImages),T=c.useMemo(()=>m==null?void 0:m.map((n,g)=>({imgPath:W(n.imgUrl),order:g+1,title:n.filename,imageType:n.imageType}))),h=c.useMemo(()=>A.map((n,g)=>({imgPath:W(n.imgUrl),order:g+1,title:n.filename,imageType:n.imageType}))),{register:p,handleSubmit:Z,reset:_e,watch:Ae,setValue:ee,formState:{errors:Te,isSubmitSuccessful:ze}}=V({mode:"all",resolver:H(Pe),defaultValues:{name:"",capacity:"",price:"",description:"",notes:"",packageListTextItems:"",policy:"",PackageListItems:[]}});ee("policy","not available");const te=localStorage.getItem("AppID"),ae=a=>{if(!S)return;const n=s==null?void 0:s.map(f=>f.packageItem),g={name:a.name,description:a.description,capacity:a.capacity,price:Number(a.price),notes:a.notes,policy:a.policy,packageListTextItems:n,productBannerImgArr:T,productMainImgArr:h,rating:S};if(n.length<=0){C.error("Please list can't be empty");return}(async()=>{try{const f=await fetch(`${x&&x.BACKEND_URL}/api/admin/package/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${te}`},body:JSON.stringify(g)});f.ok||C("Internal error");const D=await f.json();console.log(D),D!=null&&D.success||C("Opps something wen wrong."),C("New package added successfully.."),dispatchREDUX(B())}catch(f){console.log(f)}})()},re=G({packageItem:E().min(3).required()}).required("You can't submit without fill the form."),{register:oe,handleSubmit:se,formState:{errors:M},reset:ne}=V({mode:"all",resolver:H(re),defaultValues:{PackageListItems:[]}}),le=a=>{v(a)},ce=a=>{y(n=>[...n,{id:Date.now(),packageItem:a.packageItem}]),setTimeout(()=>{ne()},100)},O=()=>{r(a=>!a)},L=()=>{i(a=>!a)};return c.useEffect(()=>{I(B())},[_.pathname]),e.createElement(e.Fragment,null,e.createElement(pe,{richColors:!0}),e.createElement(K,{isModalOpen:w,contentLabel:"banner-ui",id:"product-banner"},e.createElement(Ie,{ToggleModal:O})),e.createElement(K,{isModalOpen:u,contentLabel:"banner-ui",id:"product-banner"},e.createElement(ke,{ToggleModal:L})),e.createElement(ue,{open:l,onOpenChange:d},e.createElement(ge,null,e.createElement(Ee,null,e.createElement(ye,null,"Add Package lists items "),e.createElement(he,null,e.createElement("span",{className:"block mb-4 pt-1 border-b"},"Lorem ipsum dolor sit amet consectetur, adipisicing elit."),e.createElement("span",null,s&&s.map(a=>e.createElement("span",{key:a.id,className:"packagesListsWrapper"},e.createElement("span",{className:"bg-neutral-100 rounded p-1 text-lg flex items-center justify-between my-2"},a.packageItem,e.createElement("span",null,e.createElement(F,{className:"size-4   rounded-full text-black cursor-pointer transition-colors ease-out duration-300 hover:bg-orange-300 hover:text-white",onClick:n=>{const g=s.filter(j=>j.id!=a.id);y(g)}})))))),e.createElement("span",null,e.createElement("form",{onSubmit:se(ce)},e.createElement("span",{className:"dialog__footer  flex mt-8 "},e.createElement(k,{className:"h-10 focus-visible:ring-offset-0 focus-visible:ring-0 rounded-r-none",placeholder:"Add new package lists item",...oe("packageItem")}),e.createElement("button",{type:"submit",className:"bg-orange-400 rounded-md w-12 flex items-center justify-center text-white rounded-l-none"},e.createElement(fe,null))),e.createElement("p",{className:"text-red-400 capitalize mt-1"},M&&(($=M.packageItem)==null?void 0:$.message)))),e.createElement("span",{className:"flex justify-end mt-4 "},e.createElement(P,{className:"bg-orange-400 hover:bg-orange-300 w-32",onClick:()=>d(a=>!a)},"Done")))))),e.createElement("div",{className:"p-20 flex justify-between"},e.createElement("div",{className:"bg-gray-200 p-6 w-[400px] h-auto rounded-lg ",id:"preview_package"},e.createElement("div",{className:"flex flex-col gap-3"},e.createElement(P,{onClick:O,className:"w-full bg-blue-400"},"Upload Banners images"),e.createElement(P,{onClick:L,className:"w-full bg-amber-400"},"Uplaod Product images")),e.createElement("span",{className:"textPackage"},e.createElement("h3",{className:"mt-4 font-medium text-2xl text-wrap"},t&&t.pkg_name),e.createElement("div",{className:"price_Cap"},e.createElement("div",{className:"flex gap-3 justify-end pt-2 pb-3"},t&&t.price?e.createElement(q,{variant:"destructive",className:"bg-orange-500 hover:bg-gray-700"},"Price:",t&&`  ${t.price}`):null,t&&t.capacity?e.createElement(q,{variant:"destructive",className:"bg-black hover:bg-gray-700"},"Capacity:",t&&`  ${t.capacity}`," People"):null),e.createElement("div",{className:"flex flex-col gap-2 "},s&&s.map(a=>e.createElement("div",{key:a.id,className:"flex justify-start items-center gap-2"},e.createElement("span",{className:"bg-green-400 size-4 rounded-full flex justify-center items-center "},e.createElement(Ne,{className:"text-white size-3"})),e.createElement("p",{className:"text-neutral-500"},a.packageItem)))),t&&t.description?e.createElement("div",{className:"Policy bg-white rounded-md px-5 py-4 mt-2"},e.createElement("h3",{className:"capitalize font-semibold"},"Description"),t&&t.description):null)),t&&t.notes?e.createElement("div",{className:"Policy bg-white rounded-md px-5 py-4 mt-2"},e.createElement("h3",{className:"capitalize font-semibold"},"Policy"),t&&t.notes):null),e.createElement("div",{className:"bg-neutral-50 rounded-md p-12 w-1/2"},e.createElement("form",{onSubmit:Z(ae)},e.createElement("div",{className:"grid gap-4"},e.createElement("div",{className:"grid gap-2"},e.createElement(N,{htmlFor:"name"},"Name"),e.createElement(k,{id:"name",type:"text",placeholder:"Basic Packages",required:!0,className:"py-6",value:t&&t.pkg_name,...p("name"),onChange:a=>{o({type:"ADD_PKG_NAME",payload:a.target.value})}})),e.createElement("div",{className:"grid gap-2"},e.createElement(N,{htmlFor:"capacity"},"Capacity"),e.createElement(k,{id:"capacity",type:"text",placeholder:"100 People",required:!0,className:"py-6",value:t&&t.capacity,...p("capacity"),onChange:a=>{o({type:"ADD_CAPACITY",payload:a.target.value})}})),e.createElement("div",{className:"grid gap-2"},e.createElement(N,{htmlFor:"price"},"Price"),e.createElement(k,{id:"price",type:"text",placeholder:"â‚¹45000",required:!0,className:"py-6",value:t&&t.price.replace("â‚¹",""),...p("price"),onChange:a=>{o({type:"ADD_PRICE",payload:a.target.value})}})),e.createElement("div",{className:"grid-gap-2"},e.createElement(N,{htmlFor:"price"},"Package rating"),e.createElement(de,{count:5,onChange:le,size:24,activeColor:"#ffd700"})),e.createElement("div",{className:"grid_gap-2"},e.createElement("div",{className:"text-sm text-neutral-400 border w-full text-left rounded-lg p-3 cursor-pointer",onClick:()=>{d(a=>!a)}},"Add Package points")),e.createElement("div",{className:"grid gap-2"},e.createElement(N,{htmlFor:"policy"},"Notes or Policy"),e.createElement(R,{id:"policy",className:"h-2",value:t&&t.notes,...p("notes"),onChange:a=>{o({type:"ADD_NOTES",payload:a.target.value})}})),e.createElement("div",{className:"grid gap-2"},e.createElement(N,{htmlFor:"description"},"Description"),e.createElement(R,{id:"description",placeholder:"Package description..",className:"h-20",value:t&&t.description,...p("description"),onChange:a=>{o({type:"ADD_DESC",payload:a.target.value})}})),e.createElement(P,{type:"submit",className:"bg-theme-color py-6 "},"Add New Package"))))))};export{ta as default};
