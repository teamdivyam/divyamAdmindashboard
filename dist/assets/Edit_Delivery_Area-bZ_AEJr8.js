import{r as c,a}from"./react-BM40__SY.js";import{D as $}from"./react-date-picker-DqVxU5es.js";import"./react-calendar-H3lCHeN-.js";import{T as H}from"./sonner-UVoS8Wfh.js";import{s as P,j as w,g as R,h as j,L as g,I as L,i as G,B as K,_ as b}from"./index-fHwZLE-T.js";import{C as O,I as J,d as X}from"./ComboBox_select-q3wZeUQA.js";import{S as Q}from"./switch-DRYMT_M7.js";import{u as W,a as ee}from"./react-redux-DNfLtVbP.js";import{c as te,e as ae,a as S}from"./yup-DazPcaNu.js";import{u as re}from"./react-hook-form-BN_naEWj.js";import{o as oe}from"./@hookform-D0jWCfUg.js";import{w as M}from"./sonner-CBLC4ypc.js";import{k as se}from"./lucide-react-BWZ2dPnB.js";import{d as ne,u as ie}from"./react-router-DRLUvzUh.js";import"./attr-accept-CkmCM30I.js";import"./react-dom-BKOhnANa.js";import"./scheduler-C323NY8X.js";import"./make-event-props-BZnwhpCt.js";import"./clsx-B-dksMZM.js";import"./react-fit-Iyg0UbAJ.js";import"./detect-element-overflow-Bqx90j58.js";import"./warning-5T6J0T5c.js";import"./@wojtekmaj-D2zmgPQ9.js";import"./update-input-width-DfrTQ4MP.js";import"./get-user-locale-Ck06Kk6_.js";import"./mem-CMUK6Jxf.js";import"./mimic-fn-kh_GziL3.js";import"./map-age-cleaner-B1I_vRRc.js";import"./p-defer-BUV9kL4s.js";import"./next-themes-05dgSDaz.js";import"./@radix-ui-Bvz2HI7m.js";import"./react-remove-scroll-DR3rXkvR.js";import"./tslib-eMSY344_.js";import"./react-remove-scroll-bar-BhARyL5A.js";import"./react-style-singleton-DeLYGn6u.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-CISbmOY4.js";import"./use-callback-ref-Bp38XRF0.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@floating-ui-DHl6l98I.js";import"./class-variance-authority-Dp3B9jqt.js";import"./tailwind-merge-D696Ktp4.js";import"./react-google-recaptcha-C2_uU7Xm.js";import"./prop-types-DFk7-3jw.js";import"./react-async-script-BL5K2liq.js";import"./hoist-non-react-statics-CPzswhKp.js";import"./react-is-CnyDuYXe.js";import"./@reduxjs-DtXgGc0i.js";import"./redux-BXkGT1VS.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./jwt-decode-VWaDGczM.js";import"./recharts-BSzae8HI.js";import"./lodash-DiYzGN5e.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-nwul2LtV.js";import"./d3-path-CimkQT29.js";import"./react-smooth-DYD8lKML.js";import"./fast-equals-BIyco3rD.js";import"./victory-vendor-eFgrrWDw.js";import"./d3-scale-DCNNTN8k.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-j2_s_XYn.js";import"./d3-time-g9mLz1m7.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-CEDTliZZ.js";import"./decimal.js-light-ZKFLnszB.js";import"./eventemitter3-BRe_pui0.js";import"./property-expr-DwgEMw67.js";import"./tiny-case-Gl8mQWqo.js";import"./toposort-tjHGMS6M.js";import"./use-sync-external-store-H6R0MgJP.js";import"./cookie--_YQFYBD.js";import"./react-day-picker-D-Izaemk.js";import"./date-fns-BZLmoul0.js";import"./select-Cd5bAGBT.js";import"./date-fns-tz-Dh4fjyPi.js";import"./command-C-zk0mwW.js";import"./cmdk-BqBG_NPy.js";import"./dialog-CwGvPLDO.js";const x=/^(((0[1-9]|[12]\d|3[01])\/(0[13578]|1[02])\/((19|[2-9]\d)\d{2}))|((0[1-9]|[12]\d|30)\/(0[13456789]|1[012])\/((19|[2-9]\d)\d{2}))|((0[1-9]|1\d|2[0-8])\/02\/((19|[2-9]\d)\d{2}))|(29\/02\/((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))))$/,ce=/^[1-9]{1}[0-9]{5}$/,T=s=>{const[e,n,i]=s.split("/").map(Number);return new Date(i,n-1,e)},me={clientStartDate:"01/01/2023",clientEndDate:"01/01/2023"},le=(s,e)=>{switch(e.type){case"SET_START_DATE":return{...s,clientStartDate:e==null?void 0:e.payload};case"SET_END_DATE":return{...s,clientStartDate:e==null?void 0:e.payload};default:return s}};function F(s){const[e,n,i]=s.split("/").map(Number);if(!e||!n||!i)throw new Error("Invalid date format. Please provide a date in DD/MM/YYYY format.");const u=String(e).padStart(2,"0"),D=String(n).padStart(2,"0");return`${i}-${D}-${u}`}const h=s=>{try{const e=new Date(s),n=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),u=e.getFullYear();return`${n}/${i}/${u}`}catch(e){console.log(e)}};function pe(s){const e=new Date(s),n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),u=String(e.getDate()).padStart(2,"0"),D=String(e.getHours()).padStart(2,"0"),N=String(e.getMinutes()).padStart(2,"0"),Y=String(e.getSeconds()).padStart(2,"0"),v=String(e.getMilliseconds()).padStart(3,"0"),I=e.getTimezoneOffset(),f=Math.abs(I),y=String(Math.floor(f/60)).padStart(2,"0"),E=String(f%60).padStart(2,"0"),d=`${I<=0?"+":"-"}${y}:${E}`;return`${n}-${i}-${u}T${D}:${N}:${Y}.${v}${d}`}const de=te({state:S().trim().min(3).required(),district:S().trim().min(3).required(),areaPinCode:S().required().matches(ce,"Invalid Pin code"),startDate:S().required(),endDate:S().required(),isAvailable:ae().required()}),Lt=()=>{const{AREA_ZONE_ID:s}=ne(),[e,n]=c.useState([]),[i,u]=c.useState(),[D,N]=c.useState("01/01/2000"),[Y,v]=c.useState("01/01/2000"),[I,f]=c.useReducer(le,me),y=ie(),E=c.useRef(null),p=W(),d=ee(t=>t.AreaZone),_=localStorage.getItem("AppID"),{register:ue,setValue:m,reset:De,formState:fe,trigger:Ee,watch:z}=re({resolver:oe(de),defaultValues:{state:"",district:"",areaPinCode:"",startDate:"",endDate:"",isAvailable:""},mode:"All"}),V=()=>{const{areaPinCode:t,district:r,endDate:o,isAvailable:l,startDate:Z,state:q}=z(),B={state:q,district:r,areaPinCode:t,startDate:F(Z),endDate:F(o),isAvailable:l};(async()=>{try{const A=await(await fetch(`${b&&b.BACKEND_URL}/api/admin/areas-zone/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`,Accept:"application/json, application/xml"},body:JSON.stringify(B)})).json();if(console.log(A),!A.success){M.error(A.msg);return}M.success(A.msg)}catch(C){console.log(C)}})()};c.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${b&&b.BACKEND_URL}/api/admin/areas-zone/${s}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`,Accept:"application/json, application/xml"}})).json();o.success===!1&&y(-1),o.success===!0&&n(o==null?void 0:o.responseData)}catch(r){M.error(`Internal error ${r.message}`),console.log(r)}})()},[]),c.useEffect(()=>{if(e.areaPinCode){E.current.value=e==null?void 0:e.areaPinCode,p(P(e==null?void 0:e.areaPinCode));const t=""+(e==null?void 0:e.areaPinCode);m("areaPinCode",t)}e.isAvailable&&(u(t=>e.isAvailable),p(w(e==null?void 0:e.isAvailable))),f({type:"SET_START_DATE",payload:pe(e==null?void 0:e.startDate)}),f({type:"SET_END_DATE",payload:h(e==null?void 0:e.endDate)})},[e,n]),c.useEffect(()=>{if(e!=null&&e.startDate){const t=h(e==null?void 0:e.startDate);if(x.test(t)){const o=T(t);isNaN(o)?console.error("Invalid Date object created from",t):(N(()=>o),p(R(t)),m("startDate",t))}else console.error("Date format is incorrect:",t)}if(e!=null&&e.endDate){const t=h(e==null?void 0:e.endDate);if(x.test(t)){const o=T(t);isNaN(o)?console.error("Invalid Date object created from",formattedStartDate):(v(()=>o),p(j(t)),m("endDate",t))}else console.error("Date format is incorrect:",formattedStartDate)}},[e,n]);const k=t=>{const r=h(t);if(x.test(r)){const l=T(r);isNaN(l)?console.error("Invalid Date object created from",r):(N(()=>l),p(R(r)),m("startDate",r))}else console.error("Date format is incorrect:",r)},U=t=>{const r=h(t);if(x.test(r)){const l=T(r);isNaN(l)?console.error("Invalid Date object created from",r):(v(()=>l),p(j(r)),m("endDate",r))}else console.error("Date format is incorrect:",r)};return c.useEffect(()=>{m("state",d==null?void 0:d.state),m("district",d==null?void 0:d.district),m("isAvailable",e==null?void 0:e.isAvailable)},[d]),c.useEffect(()=>{m("isAvailable",i)},[i,w]),a.createElement(a.Fragment,null,a.createElement(H,{richColors:!0}),a.createElement("div",{className:"mx-auto"},a.createElement("div",{className:" mx-4 rounded-sm p-2 py-4"},a.createElement("h1",{className:"capitalize text-2xl border-b font-normal pb-3"},"Update Area Zone"),a.createElement("div",{className:"border  mx-auto max-w-2xl rounded-md bg-slate-50 p-4 mt-6",id:"form_wrapper"},a.createElement("form",{className:"flex flex-col gap-4",onSubmit:t=>{t.preventDefault()}},a.createElement("div",{className:"flex flex-col gap-2"},a.createElement(g,{htmlFor:"state",className:"text-neutral-400"},"State"),a.createElement("span",{className:"w-full "},a.createElement(O,{placeHolderText:"Select State",optionsText:J,inputType:"STATE",inputDefaultVal:e&&(e==null?void 0:e.state)}))),a.createElement("div",{className:"flex flex-col gap-2 "},a.createElement(g,{htmlFor:"district",className:"text-neutral-400"},"District"),a.createElement(O,{inputType:"DISTRICT",placeHolderText:"Select district",optionsText:X,inputDefaultVal:e&&(e==null?void 0:e.district)})),a.createElement("div",{className:"flex flex-col gap-2 -mt-2"},a.createElement(g,{htmlFor:"areaPin",className:"text-neutral-400 "},"Pin code"),a.createElement("span",{className:" flex h-10"},a.createElement(L,{className:`
                border-r-0
               rounded-r-none
                h-12`,placeholder:"Enter area pin code",ref:E,onChange:t=>{var r,o,l;E.current.value=(r=t==null?void 0:t.target)==null?void 0:r.value,p(P((o=t==null?void 0:t.target)==null?void 0:o.value)),m("areaPinCode",(l=t==null?void 0:t.target)==null?void 0:l.value)}}),a.createElement("button",null,a.createElement("span",{className:"bg-orange-300 rounded-sm h-12  w-12  text-white border-l-0 rounded-l-none flex justify-center items-center"},a.createElement(se,{className:"size-4"}))))),a.createElement("div",{className:"flex flex-col gap-2"},a.createElement(g,{htmlFor:"firstDate",className:"text-neutral-400 "},"Start Date"),a.createElement($,{onChange:k,value:D,className:"bg-slate-50 border p-1 rounded-md h-12"})),a.createElement("div",{className:"flex flex-col gap-2"},a.createElement(g,{htmlFor:"firstDate",className:"text-neutral-400 "},"End Date"),a.createElement($,{onChange:U,value:Y,className:"bg-slate-50 border p-1 rounded-md h-12"})),a.createElement("div",{className:"border p-4 rounded-md shadow-sm flex justify-between items-center"},a.createElement("div",{className:"toggleSwitchTextContent"},a.createElement("h3",{className:"font-medium"},"Service Availability"),a.createElement("p",{className:"text-neutral-500"},"Set the status if the service is available or offline.")),a.createElement(Q,{className:"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-orange-200",checked:i,onCheckedChange:t=>{u(r=>!r),p(G())}})),a.createElement("div",{className:"flex flex-col gap-2"},a.createElement(K,{className:"bg-[#ffa94e] uppercase font-semibold hover:bg-orange-300 mt-5 h-12",onClick:()=>{V()}},"Update area zone")))))))};export{Lt as default};
