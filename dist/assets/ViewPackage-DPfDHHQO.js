import{a as e,r as g}from"./react-BM40__SY.js";import{S as b,_ as S,u as X,f as q,r as ie,I as P,B as k,L as x}from"./index-fHwZLE-T.js";import{T as G}from"./textarea-CVz0WJ5F.js";import{B}from"./badge-DAiYVQtE.js";import{T as pe}from"./sonner-UVoS8Wfh.js";import{w as O}from"./sonner-CBLC4ypc.js";import{D as de,a as ue,b as ge,c as Ee,d as ye}from"./dialog-CwGvPLDO.js";import{S as $}from"./switch-DRYMT_M7.js";import{R as fe}from"./react-rating-stars-component-BRBZw8gx.js";import{o as j}from"./@hookform-D0jWCfUg.js";import{c as Y,a as y}from"./yup-DazPcaNu.js";import{u as K}from"./react-hook-form-BN_naEWj.js";import{$ as he,e as Ie}from"./react-photo-view-C-LKjczn.js";import{M as V}from"./Modal-aaWU-vqU.js";import{u as J}from"./react-dropzone-xdj4i9O1.js";import{i as Q}from"./browser-image-compression-BgY3rL5_.js";import{n as Z}from"./@reduxjs-DtXgGc0i.js";import{u as F,a as C}from"./react-redux-DNfLtVbP.js";import{S as ee,g as H}from"./extractFileNameFromImgUrl-BGUkp9r3.js";import{X as z,l as Ne,a as xe}from"./lucide-react-BWZ2dPnB.js";import{N as be}from"./react-number-format-CL_XDg95.js";import{d as Se}from"./react-router-DRLUvzUh.js";import"./attr-accept-CkmCM30I.js";import"./react-dom-BKOhnANa.js";import"./scheduler-C323NY8X.js";import"./@radix-ui-Bvz2HI7m.js";import"./react-remove-scroll-DR3rXkvR.js";import"./tslib-eMSY344_.js";import"./react-remove-scroll-bar-BhARyL5A.js";import"./react-style-singleton-DeLYGn6u.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-CISbmOY4.js";import"./use-callback-ref-Bp38XRF0.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@floating-ui-DHl6l98I.js";import"./class-variance-authority-Dp3B9jqt.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-D696Ktp4.js";import"./react-google-recaptcha-C2_uU7Xm.js";import"./prop-types-DFk7-3jw.js";import"./react-async-script-BL5K2liq.js";import"./hoist-non-react-statics-CPzswhKp.js";import"./react-is-CnyDuYXe.js";import"./jwt-decode-VWaDGczM.js";import"./recharts-BSzae8HI.js";import"./lodash-DiYzGN5e.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-nwul2LtV.js";import"./d3-path-CimkQT29.js";import"./react-smooth-DYD8lKML.js";import"./fast-equals-BIyco3rD.js";import"./victory-vendor-eFgrrWDw.js";import"./d3-scale-DCNNTN8k.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-j2_s_XYn.js";import"./d3-time-g9mLz1m7.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-CEDTliZZ.js";import"./decimal.js-light-ZKFLnszB.js";import"./eventemitter3-BRe_pui0.js";import"./property-expr-DwgEMw67.js";import"./tiny-case-Gl8mQWqo.js";import"./toposort-tjHGMS6M.js";import"./use-sync-external-store-H6R0MgJP.js";import"./redux-BXkGT1VS.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./cookie--_YQFYBD.js";import"./next-themes-05dgSDaz.js";import"./react-modal-Cc-lLjh3.js";import"./warning-5T6J0T5c.js";import"./exenv-BS7ugsZD.js";import"./react-lifecycles-compat-CbhsFY8R.js";import"./file-selector-Bf0AE8ON.js";const Te=({Images:o})=>{if(o)return e.createElement("div",{className:"flex gap-2 flex-wrap"},e.createElement(he,null,o.map((s,m)=>e.createElement(Ie,{key:m,src:s.imgSrc},e.createElement("img",{src:s.imgSrc,className:"size-12 rounded-lg"})))))},W=e.memo(Te),we=localStorage,ve=async o=>{try{return await(await fetch(`${S.BACKEND_URL}/api/admin/get-presigned-url`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${we}`},body:JSON.stringify({fileName:o})})).json()}catch{throw new Error("cant get presigned url")}},_e=({ToggleModal:o,Images:s})=>{const[m,d]=g.useState(),t=F(),n=C(c=>c.UploadedImgs.banners),E=async c=>{const l=`UI/product-banner/${Z(12)}-${c[0].name}`;d(!0);try{const{url:p,key:I}=await ve(l),_={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},T=await Q(c[0],_);await(async()=>{if(!(await fetch(p,{method:"PUT",headers:{"Content-Type":c[0].type},body:T})).ok)throw new Error("Error during file upload");const w=`${S.IMAGE_CDN}/${l}`;console.log("Uploaded Image URL:",w),d(!1);const N={imgUrl:w,fileName:c[0].name,fileSize:T.size};t(X(N))})()}catch(p){console.error("Upload Error:",p),d(!1)}},{acceptedFiles:f,getRootProps:v,getInputProps:h}=J({onDrop:E,accept:{"image/*":[]}});return e.createElement(e.Fragment,null,e.createElement("div",{className:"lg:min-w-[800px]  h-[350px]  overflow-y-auto"},e.createElement("div",{className:"file_Upload__header border-b flex justify-between p-4"},e.createElement("h2",{className:"text-gray-600 text-2xl "},"Update Banner Images"),e.createElement("span",{className:"close-icon hover:bg-gray-800 size-10 flex justify-center items-center rounded-full group ease-in duration-75 transition-colors",id:"modal-close",onClick:o},e.createElement(z,{className:"text-gray-300 size-8 cursor-pointer group-hover:text-white"}))),e.createElement("div",{className:"file-upload-wrapper px-4 my-4"},e.createElement("div",{...v({className:"dropzone"}),className:"rounded-md border-2 border-dashed mx-auto w-5/6 my-4 p-6 cursor-copy"},e.createElement("input",{...h()}),e.createElement("p",{className:"text-gray-300"},"Drag 'n' drop some files here, or click to select files")),m&&e.createElement("div",{className:"container border p-3 rounded-md transition-all ease-in mb-2"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(b,{className:"h-12 w-12 rounded-md"}),e.createElement("div",{className:"space-y-2"},e.createElement(b,{className:"h-4 w-[250px]"}),e.createElement(b,{className:"h-4 w-[50px]"})))),e.createElement("div",{className:"flex flex-col gap-2"},n&&n.length>=0&&n.map(c=>e.createElement(ee,{File:c,Size:c.fileSize,key:c.id,ImgUrl:c.imgUrl,ISUploading:m}))))))},De=e.memo(_e),Ae=localStorage.getItem("AppID"),Pe=async o=>{try{return await(await fetch(`${S.BACKEND_URL}/api/admin/get-presigned-url`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ae}`},body:JSON.stringify({fileName:o})})).json()}catch{throw new Error("cant get presigned url")}},ke=({ToggleModal:o,Images:s,Title:m})=>{const[d,t]=g.useState(),n=F(),E=C(l=>l.UploadedImgs.productImages),f=async l=>{const p=`UI/product-Img/${Z(12)}-${l[0].name}`;t(!0);try{const{url:I,key:_}=await Pe(p),T={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},D=await Q(l[0],T);await(async()=>{if(!(await fetch(I,{method:"PUT",headers:{"Content-Type":l[0].type},body:D})).ok)throw new Error("Error during file upload");const N=`${S.IMAGE_CDN}/${p}`;console.log("Uploaded Image URL:",N),t(!1);const U={imgUrl:N,fileName:l[0].name,fileSize:D.size};n(q(U))})()}catch(I){console.error("Upload Error:",I),t(!1)}},{acceptedFiles:v,getRootProps:h,getInputProps:c}=J({onDrop:f,accept:{"image/*":[]}});return e.createElement(e.Fragment,null,e.createElement("div",{className:"lg:min-w-[800px] max-w-[800px]  h-[350px]  overflow-y-auto"},e.createElement("div",{className:"file_Upload__header border-b flex justify-between p-4"},e.createElement("h2",{className:"text-gray-600 text-2xl "},m),e.createElement("span",{className:"close-icon hover:bg-gray-800 size-10 flex justify-center items-center rounded-full group ease-in duration-75 transition-colors",id:"modal-close",onClick:o},e.createElement(z,{className:"text-gray-300 size-8 cursor-pointer group-hover:text-white"}))),e.createElement("div",{className:"file-upload-wrapper px-4 my-4"},e.createElement("div",{...h({className:"dropzone"}),className:"rounded-md border-2 border-dashed mx-auto w-5/6 my-4 p-6 cursor-copy"},e.createElement("input",{...c()}),e.createElement("p",{className:"text-gray-300"},"Drag 'n' drop some files here, or click to select files")),d&&e.createElement("div",{className:"container border p-3 rounded-md transition-all ease-in mb-2"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(b,{className:"h-12 w-12 rounded-md"}),e.createElement("div",{className:"space-y-2"},e.createElement(b,{className:"h-4 w-[250px]"}),e.createElement(b,{className:"h-4 w-[50px]"})))),e.createElement("div",{className:"flex flex-col gap-2"},E&&E.length>=0&&E.map(l=>e.createElement(ee,{File:l,Size:l.fileSize,key:l.id,ImgUrl:l.imgUrl,ISUploading:d}))))))},Ce=e.memo(ke),te={name:"",capacity:"",price:"",notes:"",description:"",packageListTextItems:[],productImgs:[],bannerImgs:[],startCount:null,isVisible:null,isFeatured:null},Ue=Y({name:y(),capacity:y(),price:y(),notes:y(),description:y(),image:y()}),Re=(o,s)=>{switch(s.type){case"RESET":return{...te};case"ADD_PKG_NAME":return{...o,name:s.payload};case"ADD_CAPACITY":return{...o,capacity:s.payload};case"ADD_PRICE":return{...o,price:`â‚¹${s.payload}`};case"ADD_NOTES":return{...o,notes:s.payload};case"ADD_DESC":return{...o,description:s.payload};case"SET_BANNER_IMG":return{...o,bannerImgs:s.payload};case"SET_PRODUCT_IMG":return{...o,productImgs:s.payload};case"SET_STAR_RATING":return{...o,startCount:s.payload};case"ADD_PKG_TXT":{const m=Array.isArray(s.payload)?s.payload:[s.payload];return{...o,packageListTextItems:[...o.packageListTextItems,...m]}}case"IMG":return{...o,image:s.payload};case"RMV_PKG_TXT":{const m=o==null?void 0:o.packageListTextItems.filter((d,t)=>t!==s.payload);return{...o,packageListTextItems:m}}case"IS_VISIBLE":return{...o,isVisible:s.payload};case"IS_PKG_FEATURED":return{...o,isFeatured:s.payload};default:return o}},sa=()=>{var M;const{PKG_ID:o}=Se(),s=C(a=>a.UploadedImgs.banners),m=C(a=>a.UploadedImgs.productImages),d=F(),[t,n]=g.useReducer(Re,te),[E,f]=g.useState(!1),[v,h]=g.useState(),[c,l]=g.useState(),{register:p,handleSubmit:I,reset:_,watch:T,formState:{errors:D}}=K({mode:"all",resolver:j(Ue),defaultValues:{name:"",capacity:"",price:"",notes:"",description:""}}),A=localStorage.getItem("AppID"),w=s.map((a,i)=>({order:i+1,imgUrl:a.imgUrl,filename:a.filename,fileSize:a.fileSize,imageType:a.imageType,imagePath:H(a.imgUrl)})),N=m.map((a,i)=>({order:i+1,imgUrl:a.imgUrl,filename:a.filename,fileSize:a.fileSize,imageType:a.imageType,imagePath:H(a.imgUrl)})),U=a=>{const i={...a,isFeaturedProduct:t.isFeatured,packageListTextItems:t.packageListTextItems,rating:t.startCount,bannerImgs:w,productImgs:N,isVisible:t.isVisible};(async()=>{try{const u=await fetch(`${S.BACKEND_URL}/api/admin/package/${o}`,{method:"PATCH",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify(i)});u.ok||O.error("Something went wrong please try again later.");const R=await u.json();(R==null?void 0:R.success)===!0&&O.success("Package updated successfully")}catch(u){console.log(u)}})()},ae=Y({packageItem:y().min(3).required()}).required("You can't submit without fill the form."),{register:re,handleSubmit:oe,formState:{errors:L},setValue:Fe,reset:se}=K({mode:"all",resolver:j(ae),defaultValues:{PackageListItems:[]}}),ne=a=>{n({type:"ADD_PKG_TXT",payload:a==null?void 0:a.packageItem}),se()},le=a=>{n({type:"SET_STAR_RATING",payload:a})};g.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${S.BACKEND_URL}/api/admin/package/${o}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`,Accept:"application/json, application/xml"}})).json();if(!r)return;n({type:"ADD_PKG_NAME",payload:r.name}),n({type:"ADD_CAPACITY",payload:r.capacity}),n({type:"ADD_PRICE",payload:r.price}),n({type:"ADD_NOTES",payload:r.notes}),n({type:"ADD_DESC",payload:r.description}),n({type:"SET_PRODUCT_IMG",payload:r==null?void 0:r.productImg}),n({type:"SET_BANNER_IMG",payload:r==null?void 0:r.productBannerImgs}),n({type:"IS_VISIBLE",payload:r==null?void 0:r.isVisible}),n({type:"IS_PKG_FEATURED",payload:r==null?void 0:r.isFeatured}),n({type:"SET_STAR_RATING",payload:r==null?void 0:r.rating}),r==null||r.packageListTextItems.forEach(u=>{n({type:"ADD_PKG_TXT",payload:u})}),_({name:r==null?void 0:r.name,capacity:r==null?void 0:r.capacity,price:r==null?void 0:r.price,description:r==null?void 0:r.description})}catch(i){console.log(i)}})()},[]);const ce=()=>{l(a=>!a)},me=()=>{h(a=>!a)};return g.useEffect(()=>{d(ie());const a=t.bannerImgs,i=t.productImgs;a.map(r=>{const u={imgUrl:r.imgSrc,fileName:r.title,fileSize:"undefined",order:r.order};d(X(u))}),i.map(r=>{const u={imgUrl:r.imgSrc,fileName:r.title,fileSize:"undefined",order:r.order};d(q(u))})},[t.bannerImgs,t.productImgs]),e.createElement("div",null,e.createElement(V,{isModalOpen:c,id:"update-product-banner-images"},e.createElement(De,{Images:t.bannerImgs,ToggleModal:ce,Title:"Update Banner Images"})),e.createElement(V,{isModalOpen:v,id:"update-product-modal-images"},e.createElement(Ce,{Images:t.productImg,ToggleModal:me,Title:"Update Product Images"})),e.createElement(pe,{richColors:!0}),e.createElement(de,{open:E,onOpenChange:f},e.createElement(ue,null,e.createElement(ge,null,e.createElement(Ee,null,"Add Package lists items "),e.createElement(ye,null,e.createElement("span",{className:"block mb-4 pt-1 border-b"},"Lorem ipsum dolor sit amet consectetur, adipisicing elit."),e.createElement("span",null,t.packageListTextItems&&t.packageListTextItems.map((a,i)=>e.createElement("span",{key:Math.random(),className:"packagesListsWrapper"},e.createElement("span",{className:"bg-neutral-100 rounded p-1 text-lg flex items-center justify-between my-2"},a,e.createElement("span",null,e.createElement(z,{role:"button",className:"size-4   rounded-full text-black cursor-pointer transition-colors ease-out duration-300 hover:bg-orange-300 hover:text-white",onClick:r=>{n({type:"RMV_PKG_TXT",payload:i})}})))))),e.createElement("span",null,e.createElement("form",{onSubmit:oe(ne)},e.createElement("span",{className:"dialog__footer  flex mt-8 "},e.createElement(P,{className:"h-10 focus-visible:ring-offset-0 focus-visible:ring-0 rounded-r-none",placeholder:"Add new package lists item",...re("packageItem")}),e.createElement("button",{type:"submit",className:"bg-orange-400 rounded-md w-12 flex items-center justify-center text-white rounded-l-none"},e.createElement(Ne,null))),e.createElement("p",{className:"text-red-400 capitalize mt-1"},L&&((M=L.packageItem)==null?void 0:M.message)))),e.createElement("span",{className:"flex justify-end mt-4 "},e.createElement(k,{className:"bg-orange-400 hover:bg-orange-300 w-32",onClick:()=>f(a=>!a)},"Done")))))),e.createElement("h2",{className:"text-2xl border-b mx-4 font-medium"},"Update Package"),e.createElement("div",{className:"p-20 flex justify-between"},e.createElement("div",{className:"bg-gray-200 p-6 w-96 h-auto rounded-lg ",id:"preview_package"},e.createElement("span",{className:"textPackage"},e.createElement("h3",{className:"mb-4 font-semibold text-2xl text-wrap capitalize"},t&&t.name),e.createElement("h2",{className:" font-normal text-neutral-600 border-b"},"Product Images"),e.createElement(W,{Images:t.productImgs}),e.createElement("h2",{className:"font-normal text-neutral-600 border-b"},"Banners Images"),e.createElement(W,{Images:t.bannerImgs}),e.createElement("div",{className:"w-full flex justify-between mx-auto mt-8 gap-4"},e.createElement(k,{onClick:()=>h(!0),className:`w-1/2 bg-stone-300 text-stone-600 hover:bg-stone-300 capitalize
              font-medium text-xs `},"Update product images"),e.createElement(k,{onClick:()=>l(!0),className:`w-1/2 bg-stone-300 text-stone-600 hover:bg-stone-300 capitalize
              font-medium text-xs `},"Update Banner images")),e.createElement("div",{className:"price_Cap"},e.createElement("div",{className:"flex gap-3 justify-end pt-2 pb-3"},e.createElement(B,{variant:"destructive",className:"bg-orange-500 hover:bg-gray-700"},"Price:",t&&e.createElement(be,{value:t.price,displayType:"text",thousandSeparator:!0,prefix:"â‚¹"})),e.createElement(B,{variant:"destructive",className:"bg-black hover:bg-gray-700"},"Capacity:",t&&`  ${t.capacity}`," People")),e.createElement("div",{className:"flex flex-col gap-2"},t.packageListTextItems&&t.packageListTextItems?t.packageListTextItems.map((a,i)=>e.createElement("div",{key:i,className:"flex justify-start items-center gap-2"},e.createElement("span",{className:"bg-green-400 size-4 rounded-full flex justify-center items-center "},e.createElement(xe,{className:"text-white size-3"})),e.createElement("p",{className:"text-neutral-500"},a))):null),t&&t.description?e.createElement("div",{className:"Policy bg-white rounded-md px-5 py-4 mt-2"},e.createElement("h3",{className:"capitalize font-semibold"},"Description"),t&&t.description):null)),t&&t.notes?e.createElement("div",{className:"Policy bg-white rounded-md px-5 py-4 mt-2"},e.createElement("h3",{className:"capitalize font-semibold"},"Policy"),t&&t.notes):null),e.createElement("div",{className:"bg-neutral-50 rounded-md p-12 w-1/2"},e.createElement("form",{onSubmit:I(U)},e.createElement("div",{className:"grid gap-4"},e.createElement("div",{className:"grid gap-2"},e.createElement(x,{htmlFor:"name"},"Name"),e.createElement(P,{id:"name",...p("name"),type:"text",placeholder:"Basic Packages",required:!0,className:"py-6",value:t&&t.name,onChange:a=>{n({type:"ADD_PKG_NAME",payload:a.target.value})}})),e.createElement("div",{className:"grid gap-2"},e.createElement(x,{htmlFor:"capacity"},"Capacity"),e.createElement(P,{id:"capacity",...p("capacity"),type:"text",placeholder:"100 People",required:!0,className:"py-6",value:t&&t.capacity,onChange:a=>{n({type:"ADD_CAPACITY",payload:a.target.value})}})),e.createElement("div",{className:"grid gap-2"},e.createElement(x,{htmlFor:"price"},"Price"),e.createElement(P,{id:"price",type:"text",placeholder:"â‚¹45000",...p("price"),required:!0,className:"py-6",value:t&&t.price.replace("â‚¹",""),onChange:a=>{n({type:"ADD_PRICE",payload:a.target.value})}})),e.createElement("div",{className:"grid_gap-2"},e.createElement("div",{className:"text-sm text-neutral-400 border w-full text-left rounded-lg p-3 cursor-pointer",onClick:()=>{f(a=>!a)}},"Add Package points")),e.createElement("div",{className:" grid gap-2 startRatingsCount"},e.createElement(x,{htmlFor:"notes"},"Ratings"),t&&(t!=null&&t.startCount)?e.createElement(fe,{count:5,onChange:le,size:24,value:t==null?void 0:t.startCount,color2:"#ffd700"}):null),e.createElement("div",{className:"grid gap-2"},e.createElement(x,{htmlFor:"notes"},"Notes or Policy"),e.createElement(G,{id:"notes",...p("notes"),className:"h-2",value:t&&t.notes,onChange:a=>{n({type:"ADD_NOTES",payload:a.target.value})}})),e.createElement("div",{className:"grid gap-2"},e.createElement("div",{className:" rounded-md border p-3 flex justify-between items-center gap-4 shadow-sm"},e.createElement("div",null,e.createElement("h2",{className:"font-normal"},"Show in Featured Section"),e.createElement("p",{className:"text-xs font-sm"},"Easily add products to the Featured category with just one click. This button helps you highlight selected products, making them stand out on your website")),e.createElement($,{checked:t&&t.isFeatured,onCheckedChange:a=>{n({type:"IS_PKG_FEATURED",payload:a})}}))),e.createElement("div",{className:"grid gap-2"},e.createElement("div",{className:" rounded-md border p-3 flex justify-between items-center gap-4 shadow-sm"},e.createElement("div",null,e.createElement("h2",{className:"font-normal"},"Product Visibility"),e.createElement("p",{className:"text-xs font-sm"},"Turn this switch on to feature this product on the customer UI. When off, the product will remain hidden from customers but still be available in your dashboard")),e.createElement($,{checked:t&&(t==null?void 0:t.isVisible),onCheckedChange:a=>{n({type:"IS_VISIBLE",payload:a})}}))),e.createElement("div",{className:"grid gap-2"},e.createElement(x,{htmlFor:"description"},"Description"),e.createElement(G,{id:"description",...p("description"),placeholder:"Package description..",className:"h-20",value:t&&t.description,onChange:a=>{n({type:"ADD_DESC",payload:a.target.value})}})),e.createElement(k,{className:"bg-theme-color py-6"},"Update Package Now"))))))};export{sa as default};
